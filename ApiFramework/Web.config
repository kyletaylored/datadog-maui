<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<appSettings>
		<!-- Datadog APM Configuration (Backend Tracing) -->
		<!-- <add key="DD_SERVICE" value="datadog-maui-api-framework" /> -->
		<!-- <add key="DD_VERSION" value="1.0.0" /> -->
		<!-- <add key="DD_ENV" value="prod" /> -->
		<add key="DD_RUNTIME_METRICS_ENABLED" value="true"/>
		<add key="DD_LOGS_INJECTION" value="true"/>
    <!-- Enable RUM tracking (default) -->
    <add key="DD_RUM_ENABLED" value="true"/>
		<!--
      Note: RUM (Browser) configuration is auto-generated from .env during build.
      See generate-rum-config.ps1 which creates rum-config.js from DD_RUM_WEB_* variables.
    -->
	</appSettings>

	<system.web>
		<compilation debug="true" targetFramework="4.8"/>
		<httpRuntime targetFramework="4.8"/>
		<customErrors mode="Off"/>
		<!-- Use Forms authentication mode="None" to allow custom bearer token auth -->
		<authentication mode="None"/>
		<authorization>
			<allow users="*"/>
		</authorization>
	</system.web>

	<system.webServer>
		<!-- Allow Authorization header to pass through to Web API -->
		<security>
			<requestFiltering allowDoubleEscaping="true">
				<requestLimits maxAllowedContentLength="10485760"/>
			</requestFiltering>
		</security>

		<!-- Enable static file serving -->
		<staticContent>
			<remove fileExtension=".json"/>
			<mimeMap fileExtension=".json" mimeType="application/json"/>
			<remove fileExtension=".woff"/>
			<mimeMap fileExtension=".woff" mimeType="application/font-woff"/>
			<remove fileExtension=".woff2"/>
			<mimeMap fileExtension=".woff2" mimeType="application/font-woff2"/>
		</staticContent>

		<!-- Set default document -->
		<defaultDocument enabled="true">
			<files>
				<clear/>
				<add value="index.html"/>
			</files>
		</defaultDocument>

		<handlers>
			<remove name="ExtensionlessUrlHandler-Integrated-4.0"/>
			<remove name="OPTIONSVerbHandler"/>
			<remove name="TRACEVerbHandler"/>
			<!-- Route all extensionless URLs through OWIN pipeline -->
			<add name="Owin" verb="*" path="*" type="Microsoft.Owin.Host.SystemWeb.OwinHttpHandler, Microsoft.Owin.Host.SystemWeb"/>
		</handlers>

		<!--
      Datadog automatic instrumentation for .NET Framework no longer requires the HTTP Module.
      As of Datadog.Trace 3.x+, instrumentation is handled by the CLR Profiler.
      Set CORECLR_ENABLE_PROFILING=1 and CORECLR_PROFILER={846F5F1C-F9AE-4B07-969E-05C26BC060D8}
      in your environment or IIS Application Pool settings.
    -->

		<!-- CORS headers -->
		<httpProtocol>
			<customHeaders>
				<add name="Access-Control-Allow-Origin" value="*"/>
				<add name="Access-Control-Allow-Headers" value="Content-Type, Authorization, X-Correlation-ID"/>
				<add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS"/>
			</customHeaders>
		</httpProtocol>

		<validation validateIntegratedModeConfiguration="false"/>
	</system.webServer>

	<runtime>
		<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
			<dependentAssembly>
				<assemblyIdentity name="Serilog" publicKeyToken="24C2F752A8E58A10" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.3.0.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Threading.Tasks.Extensions" publicKeyToken="CC7B13FFCD2DDD51" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.2.4.0" newVersion="4.2.4.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="B03F5F7F11D50A3A" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-6.0.3.0" newVersion="6.0.3.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Numerics.Vectors" publicKeyToken="B03F5F7F11D50A3A" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.1.6.0" newVersion="4.1.6.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Memory" publicKeyToken="CC7B13FFCD2DDD51" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.0.5.0" newVersion="4.0.5.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Diagnostics.DiagnosticSource" publicKeyToken="CC7B13FFCD2DDD51" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-10.0.0.3" newVersion="10.0.0.3"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Buffers" publicKeyToken="CC7B13FFCD2DDD51" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.0.5.0" newVersion="4.0.5.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="Microsoft.Owin" publicKeyToken="31BF3856AD364E35" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-4.2.3.0" newVersion="4.2.3.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-13.0.0.0" newVersion="13.0.0.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Net.Http.Formatting" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-6.0.0.0" newVersion="6.0.0.0"/>
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Web.Http" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
				<bindingRedirect oldVersion="0.0.0.0-5.3.0.0" newVersion="5.3.0.0"/>
			</dependentAssembly>
		</assemblyBinding>
	</runtime>
</configuration>
